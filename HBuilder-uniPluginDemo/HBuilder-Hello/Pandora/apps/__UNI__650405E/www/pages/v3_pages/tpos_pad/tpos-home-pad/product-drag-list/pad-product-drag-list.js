"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var b=Object.create;var f=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var S=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var A=(i,e,s,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of x(e))!T.call(i,a)&&a!==s&&f(i,a,{get:()=>e[a],enumerable:!(o=L(e,a))||o.enumerable});return i};var m=(i,e,s)=>(s=i!=null?b(w(i)):{},A(e||!i||!i.__esModule?f(s,"default",{value:i,enumerable:!0}):s,i));var h=S((B,y)=>{y.exports=Vue});var R=m(h());function p(i,e,...s){uni.__log__?uni.__log__(i,e,...s):console[i].apply(console,[...s,e])}var v=(i,e)=>{let s=i.__vccOpts||i;for(let[o,a]of e)s[o]=a;return s};var t=m(h());var _="/static/base/back_icon.png";var I={"nav-bar-view":{"":{backgroundColor:"#FFFFFF"}},"back-button":{"":{display:"flex",justifyContent:"center"}},"content-view":{"":{display:"flex",alignItems:"center",justifyContent:"center"}},"navgation-bar":{"":{paddingTop:12,paddingRight:18,paddingBottom:12,paddingLeft:18,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:"rgba(224,224,224,0.5)",position:"relative",display:"flex"}},title:{".navgation-bar ":{textAlign:"center",fontSize:15,fontWeight:"bold",color:"#121212"},".left-item ":{color:"#121212",fontSize:14,fontWeight:"bold"}},"white-round-bg":{"":{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,borderTopLeftRadius:10,borderTopRightRadius:10,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:1,borderStyle:"solid",borderColor:"rgba(224,224,224,0.5)"}},container:{"":{display:"flex",flexDirection:"row",justifyContent:"space-between",backgroundColor:"#f6f6f6",color:"#8A8A8E",fontSize:14,paddingTop:12,paddingRight:12,paddingBottom:0,paddingLeft:12,boxSizing:"border-box"}},"left-view":{".container ":{boxSizing:"border-box",marginRight:12,display:"flex",flexDirection:"column"}},"left-list-view":{".left-view ":{flex:1}},"left-item":{".left-list-view ":{marginTop:16,marginRight:10,marginBottom:0,marginLeft:10,paddingTop:14,paddingRight:20,paddingBottom:14,paddingLeft:20,borderRadius:5,overflow:"hidden"}},"sub-title":{".left-item ":{fontSize:12,color:"#BABAC4",marginTop:2}},"selected-item":{".left-list-view ":{backgroundColor:"#F2F3FF"}},"right-view":{".container ":{flex:1,boxSizing:"border-box",display:"flex",flexDirection:"column"}},"nav-right-view":{".navgation-bar ":{position:"absolute",right:8,top:6}},"blue-button":{"":{backgroundColor:"#006DE2",borderRadius:9,fontSize:14,color:"#ffffff",borderWidth:0,borderColor:"#000000",overflow:"hidden",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,textAlign:"center"}},"right-list-view":{"":{flex:1,display:"flex"}},"empty-view":{"":{display:"flex",alignItems:"center",justifyContent:"center",flex:1}},"empty-img":{"":{width:150,height:150}},"empty-text":{"":{color:"#AAAAAA",fontSize:14,marginTop:10}}},r,k={data(){return{statusbarHeight:20,navHeight:74,screenHeight:0,screenWidth:0,listHeight:0,dataList:[],tposStoreId:0,categoryInfo:{},navTitleHeight:0,pageType:"",areaId:"",tipsTitleList:[],options:{},emptyInfo:{title:"\u6682\u65E0\u684C\u53F0",img:"empty_table.png",img_height:126,img_width:216},leftData:null,selectedLeftIndex:0,selectedLeftItem:{},dragHeight:0,showRightButton:!1,newList:[],isLoading:!0}},onLoad(i){this.options=i,r=getApp({allowDefault:!0}),this.screenHeight=r.globalData.screenHeight,this.screenWidth=r.globalData.screenWidth,p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:110","statusbarHeight =>",this.statusbarHeight),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:111","navHeight =>",this.navHeight),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:112","screenWidth =>",this.screenWidth),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:113","screenHeight =>",this.screenHeight),this.navTitleHeight=this.navHeight-this.statusbarHeight,this.categoryInfo=JSON.parse(i.categoryInfo||"{}"),this.tposStoreId=r.globalData.currentTposStoreId,this.listHeight=r.globalData.screenHeight-this.navHeight,this.dragHeight=this.listHeight-12,this.pageType=i.pageType,this.title=this.categoryInfo.name,this.initData(i)},onShow(){(r.globalData.needRefreshTposArea||r.globalData.needRefreshTposCategory)&&this.initData(this.options)},methods:{initData(i){this.isLoading=!0,this.showRightButton=!1,this.dataList=[],this.pageType=="table"?(this.tipsTitleList=["\u684C\u53F0\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.requestAreaList()):this.pageType=="area"?(this.tipsTitleList=["\u533A\u57DF\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.requestAreaList()):this.pageType=="category"?(this.tipsTitleList=["\u5206\u7C7B\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.requestCategoryList()):this.pageType=="product"&&(this.tipsTitleList=["\u5546\u54C1\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.emptyInfo.title="\u6682\u65E0\u5546\u54C1",this.emptyInfo.img="empty_product.png",this.requestCategoryList())},clickLeft(){uni.navigateBack()},rightAction(){this.pageType=="area"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section"}),this.pageType=="category"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?pageType=category"})},requestProductList(){uni.showLoading({}),this.isLoading=!0,r.tposApi().getSortProductList(this.tposStoreId,this.categoryInfo.id).then(i=>{uni.hideLoading(),r.utils().getProductLanguage(i,"product","xxx");let e=[];i.forEach(s=>{e.push({title:s.name,icon:s.imgs?s.imgs[0]:"",id:s.id,name_text:s.name,img_url:s.imgs?s.imgs[0]:""})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:189","dataList =>",e),this.dataList=e,this.$refs.dragList&&(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:192","\u51C6\u5907\u5237\u65B0 =>",this.$refs.dragList),this.$refs.dragList.reloadData(e)),this.isLoading=!1})},requestTableList(){uni.showLoading({}),r.tposApi().getSortTableList(this.tposStoreId,this.areaId).then(i=>{uni.hideLoading();let e=[];i.forEach(s=>{e.push({id:s.id,name_text:s.table_name})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:211","dataList =>",e),this.dataList=e,this.$refs.dragList&&(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:215","\u51C6\u5907\u5237\u65B0 =>",this.$refs.dragList),this.$refs.dragList.reloadData(e)),this.isLoading=!1})},requestCategoryList(){r.tposApi().getSortAllCategoryList(this.tposStoreId).then(i=>{let e=[];i.forEach(s=>{r.utils().getProductLanguage(s,"category","xxx");let o={id:s.id,name_text:s.name,sub_title:s.product_num+"\u4E2A\u5546\u54C1",classify_translations:s.classify_translations};e.push(o)}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:236","dataList =>",e),this.pageType=="product"?(this.leftData=e,this.selectedLeftAction(this.selectedLeftIndex)):this.dataList=e})},requestAreaList(){let i=this.pageType=="table"?1:2;r.tposApi().getTableSectionList(this.tposStoreId,i).then(e=>{let s=[];e.forEach(o=>{s.push({id:o.id,name_text:o.area_name,sub_title:o.table_num+"\u4E2A\u684C\u53F0"})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:265","dataList =>",s),this.pageType=="table"?(this.leftData=s,this.selectedLeftAction(this.selectedLeftIndex)):this.dataList=s})},didChangeDataList(i){if(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:276","**** \u4F4D\u7F6E\u5DF2\u66F4\u65B0 => ",i.detail),i.detail){let e=i.detail.dataList;this.newList=e,this.showRightButton=!0,this.pageType=="table"||(this.pageType=="area"?this.confirmAreaListSave(e):this.pageType=="category"&&this.confirmCategorySave(e))}},confirmProductSortSave(i){uni.showLoading({mask:!0});let e=[];i.forEach((s,o)=>{e.push({id:s.id,rank:o+1,name:s.title})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:308","params =>",e),r.tposApi().sortProduct(e).then(s=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),r.globalData.needRefreshTposProduct=!0,this.initData()})},confirmTableSortSave(i){uni.showLoading({mask:!0});let e=[];i.forEach((s,o)=>{e.push({id:s.id,rank:o+1,name:s.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:334","params =>",e),r.tposApi().updateTableList(this.tposStoreId,e).then(s=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),r.globalData.needRefreshTposTable=!0,this.initData()})},confirmAreaListSave(i){uni.showLoading({mask:!0});let e=[];i.forEach((s,o)=>{e.push({id:s.id,rank:o+1,name:s.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:360","params =>",e),r.tposApi().setAreaSort(this.tposStoreId,e).then(s=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),r.globalData.needRefreshTposArea=!0,setTimeout(()=>{uni.navigateBack()},300)})},confirmCategorySave(i){uni.showLoading({mask:!0});let e=[];i.forEach((s,o)=>{e.push({id:s.id,rank:o+1,name:s.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:385","params =>",e),r.tposApi().sortProductCategory(this.tposStoreId,e).then(s=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),r.globalData.needRefreshTposCategory=!0,setTimeout(()=>{uni.navigateBack()},300)})},tapEditAction(i){if(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:398","**** \u4F4D\u7F6E\u5DF2\u66F4\u65B0 => ",i.detail),i.detail){let e=i.detail.item;p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:401","tapEditAction =>",e),this.pageType=="area"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?section_title="+e.name_text+"&area_id="+e.id}),this.pageType=="category"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?pageType=category&dataInfo="+JSON.stringify(e)})}},selectedLeftAction(i){this.selectedLeftIndex=i,this.selectedLeftItem=this.leftData[i],p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list.nvue:420"," selectedLeftItem =>",this.selectedLeftItem),this.pageType=="table"&&(this.areaId=this.selectedLeftItem.id,this.requestTableList()),this.pageType=="product"&&(this.categoryInfo=this.leftData[i],this.requestProductList())},confirmSave(){this.pageType=="product"?this.confirmProductSortSave(this.newList):this.confirmTableSortSave(this.newList)}}};function D(i,e,s,o,a,l){let u=(0,t.resolveComponent)("tpos-drag-list");return(0,t.openBlock)(),(0,t.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,t.createElementVNode)("view",{style:(0,t.normalizeStyle)("background-color: #f6f6f6;width: 750rpx;height: "+a.screenHeight+"px;")},[(0,t.createElementVNode)("view",{class:"nav-bar-view",style:(0,t.normalizeStyle)("height:"+a.navHeight+"px;padding-top:"+a.statusbarHeight+"px;")},[(0,t.createElementVNode)("u-text",{class:"center-text",style:(0,t.normalizeStyle)("height: "+a.navTitleHeight+"px;line-height:"+a.navTitleHeight+"px;width:590rpx;font-size:17px;font-weight:bold;left:30rpx;position: absolute;bottom:0;z-index:1;")},(0,t.toDisplayString)(i.title),5),(0,t.createElementVNode)("view",{class:"back-button",style:(0,t.normalizeStyle)("height: "+a.navTitleHeight+"px;width:40rpx;position: absolute;z-index:100;left:0; bottom:0;"),onClick:e[0]||(e[0]=(...d)=>l.clickLeft&&l.clickLeft(...d))},[(0,t.createElementVNode)("u-image",{src:_,style:"height:17rpx;width:17rpx; margin-left: 7rpx;",mode:""})],4)],4),a.pageType=="table"||a.pageType=="product"?((0,t.openBlock)(),(0,t.createElementBlock)("view",{key:0,class:"container",style:(0,t.normalizeStyle)("width:"+a.screenWidth+"px; height:"+a.listHeight+"px;")},[(0,t.createElementVNode)("view",{class:"left-view white-round-bg",style:(0,t.normalizeStyle)("width:"+a.screenWidth*.3953+"px; height:"+a.dragHeight+"px;")},[(0,t.createElementVNode)("view",{class:"navgation-bar space-between"},[(0,t.createElementVNode)("u-text",{class:"title",style:(0,t.normalizeStyle)("text-align: left;width:"+(a.screenWidth*.3953-36)+"px;")},(0,t.toDisplayString)(a.pageType=="table"?"\u9009\u62E9\u533A\u57DF":"\u9009\u62E9\u5206\u7C7B"),5)]),(0,t.createElementVNode)("view",{class:"left-list-view",style:{height:"100%",width:"100%"}},[(0,t.createElementVNode)("list",{scrollY:"",scrollWithAnimation:"",style:{height:"100%",width:"100%"}},[(0,t.createElementVNode)("cell",{style:{height:"16px"}}),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(a.leftData,(d,g)=>((0,t.openBlock)(),(0,t.createElementBlock)("cell",{class:(0,t.normalizeClass)("left-item"+(a.selectedLeftIndex==g?" selected-item":"")),key:g,onClick:C=>l.selectedLeftAction(g)},[(0,t.createElementVNode)("u-text",{class:"title"},(0,t.toDisplayString)(d.name_text),1),(0,t.createElementVNode)("u-text",{class:"sub-title"},(0,t.toDisplayString)(d.sub_title),1)],10,["onClick"]))),128)),(0,t.createElementVNode)("cell",{style:{height:"16px"}})])])],4),(0,t.createElementVNode)("view",{class:"right-view white-round-bg",style:(0,t.normalizeStyle)("height:"+a.dragHeight+"px;")},[(0,t.createElementVNode)("view",{class:"navgation-bar space-between"},[(0,t.createElementVNode)("u-text",{class:"title flex-1"},(0,t.toDisplayString)(a.selectedLeftItem.name_text)+(0,t.toDisplayString)(a.pageType=="table"?"\u684C\u53F0\u6392\u5E8F":"\u6392\u5E8F"),1),(0,t.createElementVNode)("view",{class:"nav-right-view",style:{height:"32px",width:"68px"}},[a.showRightButton?((0,t.openBlock)(),(0,t.createElementBlock)("u-text",{key:0,class:"blue-button small-blue-button",style:{height:"32px",width:"68px"},onClick:e[1]||(e[1]=(...d)=>l.confirmSave&&l.confirmSave(...d))},"\u786E\u5B9A")):(0,t.createCommentVNode)("",!0)])]),(0,t.createElementVNode)("view",{class:"right-list-view",style:(0,t.normalizeStyle)("width: 100%;height:"+(a.dragHeight-52)+"px;")},[a.dataList&&a.dataList.length>0?((0,t.openBlock)(),(0,t.createBlock)(u,{key:0,ref:"dragList",style:(0,t.normalizeStyle)("width:100%; height:"+(a.dragHeight-52)+"px;"),dataList:a.dataList,tips:a.tipsTitleList,hideButton:!0,cellType:"gray-bg",confirmTitle:"\u4FDD\u5B58",onTool_action:l.tapEditAction,onDid_changed:l.didChangeDataList},null,8,["style","dataList","tips","onTool_action","onDid_changed"])):a.isLoading?(0,t.createCommentVNode)("",!0):((0,t.openBlock)(),(0,t.createElementBlock)("view",{key:1,class:"empty-view",style:{width:"100%",height:"100%"}},[(0,t.createElementVNode)("u-image",{class:"empty-img",src:"/static/empty/tpos_empty/"+a.emptyInfo.img,mode:""},null,8,["src"]),(0,t.createElementVNode)("u-text",{class:"empty-text"},(0,t.toDisplayString)(a.emptyInfo.title),1)]))],4)],4)],4)):a.dataList.length>0?((0,t.openBlock)(),(0,t.createElementBlock)("view",{key:1,class:"content-view",style:(0,t.normalizeStyle)("width:"+a.screenWidth+"px; height:"+a.listHeight+"px;")},[(0,t.createVNode)(u,{ref:"dragList",style:(0,t.normalizeStyle)("width: 750rpx; height:"+a.listHeight+"px;background-color: gray;"),dataList:a.dataList,tips:a.tipsTitleList,confirmTitle:"\u4FDD\u5B58",onTool_action:l.tapEditAction,onConfirm_update:l.didChangeDataList},null,8,["style","dataList","tips","onTool_action","onConfirm_update"])],4)):(0,t.createCommentVNode)("",!0)],4)])}var n=v(k,[["render",D],["styles",[I]]]);var c=plus.webview.currentWebview();if(c){let i=parseInt(c.id),e="pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/pad-product-drag-list",s={};try{s=JSON.parse(c.__query__)}catch(a){}n.mpType="page";let o=Vue.createPageApp(n,{$store:getApp({allowDefault:!0}).$store,__pageId:i,__pagePath:e,__pageQuery:s});o.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...n.styles||[]])),o.mount("#root")}})();
