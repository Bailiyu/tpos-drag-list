"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var v=Object.create;var c=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var A=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of b(t))!T.call(e,o)&&o!==a&&c(e,o,{get:()=>t[o],enumerable:!(r=x(t,o))||r.enumerable});return e};var h=(e,t,a)=>(a=e!=null?v(L(e)):{},A(t||!e||!e.__esModule?c(a,"default",{value:e,enumerable:!0}):a,e));var g=w((D,u)=>{u.exports=Vue});var F=h(g());function p(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}var m=(e,t)=>{let a=e.__vccOpts||e;for(let[r,o]of t)a[r]=o;return a};var s=h(g());var f="/static/base/back_icon.png";var S={"nav-bar-view":{"":{display:"flex",flexDirection:"row",width:"750rpx",height:"100rpx",justifyContent:"space-between",color:"#FFFFFF",backgroundColor:"#FFFFFF"}},"center-text":{"":{flex:1,color:"#121212",position:"absolute",textAlign:"center",left:0,right:0,bottom:0,fontSize:"32rpx",fontWeight:"bold"}},"back-button":{"":{marginLeft:10}},"back-icon":{"":{width:"40rpx",height:"40rpx",display:"flex"}},"top-view":{"":{height:44,width:100,display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#FFFFFF",flexDirection:"row",color:"#8A8A8E",fontSize:"24rpx"}},"row-reverse":{"":{display:"flex",flexDirection:"row-reverse"}},"bottom-fixed-view":{"":{width:100,position:"fixed",bottom:0,zIndex:10,display:"flex",justifyContent:"space-between",paddingTop:"22rpx",paddingRight:"54rpx",paddingBottom:24,paddingLeft:"54rpx",boxSizing:"border-box",left:0}},"blue-button":{"":{width:100,color:"#FFFFFF"}},"content-view":{"":{display:"flex",alignItems:"center",justifyContent:"center"}},"empty-view":{"":{display:"flex",alignItems:"center",paddingTop:250,flex:1}},"empty-img":{"":{width:"280rpx",height:"280rpx"}},"empty-text":{"":{color:"#AAAAAA",fontSize:"28rpx",marginTop:"20rpx"}},"@FONT-FACE":[{"center-text":{"":{textAlign:"left"}}}]},i,I={data(){return{statusbarHeight:0,navHeight:0,screenHeight:0,screenWidth:0,listHeight:0,dataList:[],tposStoreId:0,categoryInfo:{},navTitleHeight:0,isPad:!1,pageType:"",areaId:"",tipsTitleList:[],options:{},emptyInfo:{title:"\u6682\u65E0\u684C\u53F0",img:"empty_table.png",img_height:126,img_width:216},isLoading:!0}},onLoad(e){p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:66","\u9875\u9762\u4F20\u503C =>",e),this.options=e,i=getApp({allowDefault:!0}),this.statusbarHeight=i.globalData.statusBarHeight,this.navHeight=i.globalData.navHeight,this.isPad=i.globalData.isPad_native,p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:75","statusbarHeight =>",this.statusbarHeight),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:76","navHeight =>",this.navHeight),this.screenHeight=i.globalData.screenHeight,this.screenWidth=i.globalData.screenWidth,this.navTitleHeight=this.navHeight-this.statusbarHeight,this.categoryInfo=JSON.parse(e.categoryInfo||"{}"),this.tposStoreId=i.globalData.currentTposStoreId,this.listHeight=i.globalData.screenHeight-i.globalData.navHeight,this.pageType=e.pageType,this.initData(e)},onShow(){(i.globalData.needRefreshTposArea||i.globalData.needRefreshTposCategory)&&this.initData(this.options)},methods:{initData(e){this.dataList=[],this.isLoading=!0,this.pageType=="table"?(this.tipsTitleList=["\u684C\u53F0\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.areaId=e.areaId,this.requestTableList()):this.pageType=="area"?(this.tipsTitleList=["\u533A\u57DF\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.requestAreaList()):this.pageType=="category"?(this.tipsTitleList=["\u5206\u7C7B\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:108","\u5206\u7C7B\u6392\u5E8F =>",this.tipsTitleList),this.requestCategoryList()):(this.tipsTitleList=["\u5546\u54C1\u540D\u79F0","\u7F6E\u9876","\u62D6\u52A8"],this.emptyInfo.title="\u6682\u65E0\u5546\u54C1",this.emptyInfo.img="empty_product.png",this.requestProductList())},clickLeft(){uni.navigateBack()},rightAction(){this.pageType=="area"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section"}),this.pageType=="category"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?pageType=category"})},cancelAction(){p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:136","\u70B9\u51FB\u4E86\u8FD4\u56DE\u6309\u94AE"),uni.navigateBack()},requestProductList(){this.isLoading=!0,i.tposApi().getSortProductList(this.tposStoreId,this.categoryInfo.id).then(e=>{i.utils().getProductLanguage(e,"product","xxx");let t=[];e.forEach(a=>{t.push({title:a.name,icon:a.imgs?a.imgs[0]:"",id:a.id,name_text:a.name,img_url:a.imgs?a.imgs[0]:""})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:154","dataList =>",t),this.dataList=t,this.isLoading=!1})},requestTableList(){this.isLoading=!0,i.tposApi().getSortTableList(this.tposStoreId,this.areaId).then(e=>{let t=[];e.forEach(a=>{t.push({id:a.id,name_text:a.table_name})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:171","dataList =>",t),this.dataList=t,this.isLoading=!1})},requestCategoryList(){uni.showLoading({}),i.tposApi().getSortAllCategoryList(this.tposStoreId).then(e=>{uni.hideLoading();let t=[];e.forEach(a=>{i.utils().getProductLanguage(a,"category","xxx");let r={id:a.id,name_text:a.name,sub_title:a.product_num+"\u4E2A\u5546\u54C1",classify_translations:a.classify_translations};t.push(r)}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:193","dataList =>",t),this.dataList=t})},requestAreaList(){uni.showLoading({}),i.tposApi().getTableSectionList(this.tposStoreId,2).then(e=>{uni.hideLoading();let t=[];e.forEach(a=>{t.push({id:a.id,name_text:a.area_name,sub_title:a.table_num+"\u4E2A\u684C\u53F0"})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:211","dataList =>",t),this.dataList=t})},didChangeDataList(e){if(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:217","**** \u4F4D\u7F6E\u5DF2\u66F4\u65B0 => ",e.detail),e.detail){let t=e.detail.dataList;this.pageType=="table"?this.confirmTableSortSave(t):this.pageType=="area"?this.confirmAreaListSave(t):this.pageType=="category"?this.confirmCategorySave(t):this.confirmProductSortSave(t)}},confirmProductSortSave(e){uni.showLoading({mask:!0});let t=[];e.forEach((a,r)=>{t.push({id:a.id,rank:r+1,name:a.title})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:244","params =>",t),i.tposApi().sortProduct(t).then(a=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),i.globalData.needRefreshTposProduct=!0,setTimeout(()=>{i.utils().backToTargetPage("tpos-product-library/tpos-product-manager")},300)})},confirmTableSortSave(e){uni.showLoading({mask:!0});let t=[];e.forEach((a,r)=>{t.push({id:a.id,rank:r+1,name:a.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:267","params =>",t),i.tposApi().updateTableList(this.tposStoreId,t).then(a=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),i.globalData.needRefreshTposTable=!0,setTimeout(()=>{uni.navigateBack()},300)})},confirmAreaListSave(e){uni.showLoading({mask:!0});let t=[];e.forEach((a,r)=>{t.push({id:a.id,rank:r+1,name:a.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:292","params =>",t),i.tposApi().setAreaSort(this.tposStoreId,t).then(a=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),i.globalData.needRefreshTposArea=!0,setTimeout(()=>{uni.navigateBack()},300)})},confirmCategorySave(e){uni.showLoading({mask:!0});let t=[];e.forEach((a,r)=>{t.push({id:a.id,rank:r+1,name:a.name_text})}),p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:317","params =>",t),i.tposApi().sortProductCategory(this.tposStoreId,t).then(a=>{uni.showToast({title:"\u4FDD\u5B58\u6210\u529F"}),i.globalData.needRefreshTposCategory=!0,setTimeout(()=>{uni.navigateBack()},300)})},tapEditAction(e){if(p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:330","**** \u4F4D\u7F6E\u5DF2\u66F4\u65B0 => ",e.detail),e.detail){let t=e.detail.item;p("log","at pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list.nvue:333","tapEditAction =>",t),this.pageType=="area"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?section_title="+t.name_text+"&area_id="+t.id}),this.pageType=="category"&&uni.navigateTo({url:"/pages/tpos/tpos-console/tpos-edit-section?pageType=category&dataInfo="+JSON.stringify(t)})}}}};function k(e,t,a,r,o,n){let _=(0,s.resolveComponent)("tpos-drag-list");return(0,s.openBlock)(),(0,s.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,s.createElementVNode)("view",{style:(0,s.normalizeStyle)("background-color: white;width: 750rpx;height: "+o.screenHeight+"px;")},[(0,s.createElementVNode)("view",{class:"nav-bar-view",style:(0,s.normalizeStyle)("height:"+o.navHeight+"px;padding-top:"+o.statusbarHeight+"px;")},[(0,s.createElementVNode)("view",{style:(0,s.normalizeStyle)("height: "+o.navTitleHeight+"px;width:100rpx;position: absolute;z-index:2;left:0; bottom:0;"),onClick:t[0]||(t[0]=(...y)=>n.cancelAction&&n.cancelAction(...y))},[(0,s.createElementVNode)("u-image",{class:"back-button",src:f,style:(0,s.normalizeStyle)("height: 48rpx;width:48rpx;margin-top:"+(o.navTitleHeight-24)/2+"px;"),mode:""},null,4)],4),(0,s.createElementVNode)("u-text",{class:"center-text",style:(0,s.normalizeStyle)("height: "+o.navTitleHeight+"px;line-height:"+o.navTitleHeight+"px;width:590rpx;font-size:34rpx;font-weight:bold;margin-left:80rpx;")},(0,s.toDisplayString)(o.categoryInfo.name),5)],4),o.dataList.length>0?((0,s.openBlock)(),(0,s.createElementBlock)("view",{key:0,class:"content-view",style:(0,s.normalizeStyle)("width:"+o.screenWidth+"px;")},[(0,s.createVNode)(_,{ref:"dragList",style:(0,s.normalizeStyle)("width: 750rpx;height:"+o.listHeight+"px;background-color: gray;"),dataList:o.dataList,tips:o.tipsTitleList,confirmTitle:"\u4FDD\u5B58",onTool_action:n.tapEditAction,onConfirm_update:n.didChangeDataList},null,8,["style","dataList","tips","onTool_action","onConfirm_update"])],4)):o.isLoading?(0,s.createCommentVNode)("",!0):((0,s.openBlock)(),(0,s.createElementBlock)("view",{key:1,class:"empty-view",style:{width:"100%",height:"100%"}},[(0,s.createElementVNode)("u-image",{class:"empty-img",src:"/static/empty/tpos_empty/"+o.emptyInfo.img,mode:""},null,8,["src"]),(0,s.createElementVNode)("u-text",{class:"empty-text"},(0,s.toDisplayString)(o.emptyInfo.title),1)]))],4)])}var l=m(I,[["render",k],["styles",[S]]]);var d=plus.webview.currentWebview();if(d){let e=parseInt(d.id),t="pages/v3_pages/tpos_pad/tpos-home-pad/product-drag-list/product-drag-list",a={};try{a=JSON.parse(d.__query__)}catch(o){}l.mpType="page";let r=Vue.createPageApp(l,{$store:getApp({allowDefault:!0}).$store,__pageId:e,__pagePath:t,__pageQuery:a});r.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...l.styles||[]])),r.mount("#root")}})();
